# Testing Skill Configuration
# This configuration controls the testing workflow behavior and system-specific settings.
# All commands and paths should be adjusted to match your project setup.

[workflow]
# When true, stops the workflow if no test plan (test-plan.md) is found before writing tests.
# This ensures tests are never written without a proper plan first.
stop_when_no_plan = true

# When true, stops the workflow if no app analysis (app-analysis.md) is found.
# App analysis captures runtime information like network calls that inform test writing.
stop_when_no_page_analysis = true

# When true, requires human review task and approval of test plans before proceeding to code tests
must_have_human_review_of_plan = true

[framework]
# Unit test framework for testing pure logic, utilities, hooks
# Common values: "vitest", "jest"
unit_test_framework = "vitest"
unit_test_framework_docs = "https://vitest.dev/guide/"

# Library used for mocking functions, modules, and code-level dependencies
# Common values: "vitest", "jest", "sinon"
unit_test_mocking_framework = "vitest"
unit_test_mocking_framework_docs = "https://vitest.dev/guide/mocking.html"

# Framework for integration/page tests (browser-based testing)
# Common values: "vitest-browser-mode", "playwright", "cypress"
integration_test_framework = "playwright"
integration_test_framework_docs = "https://playwright.dev/docs/intro"

# Library used for intercepting and mocking network requests
# For Playwright: use page.route() API for network interception
# Common values: "msw", "nock", "cy.intercept", "playwright-route"
network_interception_framework = "playwright-route"
network_interception_framework_docs = "https://playwright.dev/docs/mock"

[commands]
# Command to start the application for testing/inspection.
# The app must be running for UI tests and page analysis.
app_start_command = "start:staging-new"

# Command to stop the application (optional).
# Set to empty string if app stops automatically or doesn't need explicit stopping.
# Useful for cleanup scripts or when running in CI.
app_stop_command = "pids=$(lsof -ti tcp:3000); [ -n '$pids' ] && kill -9 $pids"

# Command to run the test suite.
# This is the primary command used after writing tests to verify they pass.
test_run_command = "pnpm test:page"

# Command to run the test suite with coverage reporting.
# Note: Playwright doesn't natively support coverage. Use test_run_command instead.
# For coverage needs, consider Istanbul instrumentation or separate unit test coverage.
test_run_command_with_coverage = "pnpm test:page"

# Command to stage changes for git.
git_stage_command = "git add -A"

[paths]
# The parent directory Where to save test all test sessions context artifacts (test plans, app analysis, etc.)
# Options:
# A custom path like "./test/.context"
test_context_root_folder = "/test/.context/"

# Name of a session-specific context folder to save artifacts of a single test session. This folder will be saved underneath test_context_root_folder.
# This folder will contain: test-plan.md, app-analysis.md, test results, etc.
test_context_folder_name_template = "test-context-{feature-or-task-name}-{two digits suffix for uniqueness}"

[app]
# The base URL of the frontend application or API
# Used for navigation during analysis and testing
app_url = "http://localhost:3000"
login_instructions = "Set localStorage 'refreshToken' with the value from .claude/skills/testing/secrets.toml. If missing, copy secrets.example.toml to secrets.toml and add your token."

[outputs]
# Filenames for the output documents
# test-plan.md is generated by the testskill.planner agent
# page-analysis.md is generated by the testskill.page-analyzer agent
# test_result_report is generated by the testskill.verifier.md
test_plan_filename = "test-plan.md"
page_analysis_filename = "page-analysis.md"
test_result_report = "test-results.md"

[canonical_example]
# A real test file that demonstrates all best practices.
# Test writers should read this before writing their first test.
path = "src/pages/Cart/Cart.page.test.ts"
title = "When API returns a few products, then they are all visible in the cart"
